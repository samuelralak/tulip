module SitesHelper
	def find_site(week, date, painter)
		# find track painter
		track_painter = TrackPainter.where(["week_number = ? and painter_id = ?", week, painter]).first

		if track_painter
			track_painter_item = track_painter.track_painter_items.find_by(date_attended: date)

			if track_painter_item
				return track_painter_item.site_id
			end
		end
	end

	def site_labour_amount(site)
		total = 0.0
		track_painter_items = TrackPainterItem.where(site_id: site.id)

		track_painter_items.each do |tpi|
			if !tpi.track_painter.painter.nil? && tpi.track_painter.painter.employment_type.code.eql?('PERMANENT')
				total += (tpi.daily_wage + tpi.daily_allowance)
			else
				total += tpi.daily_allowance
			end
		end

		total = total + site.initial_labour_amount
		
		return total
	end
   
        def total_paid(site)
	end
end
